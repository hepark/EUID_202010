[← BACK](./README.md)

# 13일차 학습

React Framework 블렌디드 러닝 Today I Learned

## DOM 객체 참조

가상 DOM을 통해 실제DOM을 업데이트 하는 React 앱의 특성상 실제 DOM객체에 접근하여 조작하는것은 사이드 이펙트를 야기 시킬 수 있다.
하지만 React에서 모든 것을 통제 할 수 없으므로 필요한 경우 ~~`ref`~~(deprecated 되었다.) `React.createRef()`를 대신 사용하자.

다음의 경우를 제외하고는 실제 DOM 조작은 자제하자.

- 포커스, 텍스트 선택영역, 미디어 재생 관리
- 써드파티 라이브러리 활용
- 애니메이션 직접 처리

## createRef

`createRef`로 실제 DOM요소에 접근/조작 할 수 있다.

```jsx
// Ref 생성
firstLinkRef = React.createRef();

handleFocusFirstMenuButton = (e) => {
  if (!e.shiftKey && e.keyCode === 9) {
    e.preventDefault();
    // current 속성으로 접근한다.
    this.firstLinkRef.current.focus();
  }
};

render(){
  return (
    <a
      ref={index === 0 ? this.firstLinkRef : null}
      href={link}
      onKeyDown={index === 0 ? this.handleFocusCloseMenuButton : null}
    >
      {text}
    </a>;
  )
}
```

부모컴포넌트에서 자식컴포넌트로 ref를 전달하면 자식컴포넌트에서는 fowardRef로 컴포넌트를 감싸줘야 한다.

```jsx
const AppButton = ({ className, children, label, ...restProps }, ref) => {
  const combieClassNames = classNames(['resetButton', className]);
  return (
    <button
      ref={ref}
      type='button'
      {...restProps}
      className={combieClassNames}
      title={label || null}
      aria-label={label || null}
    >
      {children}
    </button>
  );
};

export default forwardRef(AppButton);
```

## 성능을 고려한 라이프 사이클 훅

전달 속성인 props 또는 컴포넌트 상태 state 값 중 일부가 업데이트 됨을 감지하여 컴포넌트 업데이트 여부를 설정 할 수 있다.

```jsx
shouldComponentUpdate(nextProps, nextState){
  // 상태 변경 감지
  if(nextState.isOpen){
    // 이벤트 연결
    window.addEventListener('keydown', this.handleEscCloseMenu);
  } else {
    // 이벤트 제거
    window.removeEventListener('keydown', this.handleEscCloseMenu);
  }
  // 컴포넌트 렌더링 처리
  return true;
}
```
